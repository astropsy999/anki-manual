# Синхронізація з Ankiweb

<!-- toc -->

**AnkiWeb** — це сервіс, який дозволяє синхронізувати колекцію між кількома пристроями та завжди навчатися онлайн. Будь ласка, зареєструйте [безкоштовний обліковий запис](https://ankiweb.net/), перш ніж виконувати наведені нижче кроки.

## Вступні відео

Для швидкого ознайомлення із синхронізацією рекомендується переглянути [вступні відео про синхронізацію](https://www.youtube.com/watch?v=YkiM4DPzSVc&list=PLGgmaKOIHykFoomqkBJAyGiDQ2kyiuTao&yt:cc=on).

## Налаштування

Щоб почати синхронізувати колекцію між пристроями, натисніть кнопку синхронізації
(у верхньому правому куті на [головному екрані](studying.md#decks)) або 'y' на клавіатурі.
З'явиться запит на введення AnkiWeb ID та пароля, які було створено під час реєстрації.

При першій синхронізації колекції Anki запитає, чи бажаєте завантажити або вивантажити дані.
Якщо на комп'ютері є картки, а обліковий запис AnkiWeb порожній, виберіть "вивантажити", щоб відправити дані на AnkiWeb.
Якщо картки вже є в обліковому записі AnkiWeb з іншого пристрою, а на комп'ютері їх немає, виберіть "завантажити", щоб замінити локальну колекцію картками з AnkiWeb.
Якщо на обох пристроях різні картки, потрібні додаткові дії, щоб уникнути втрати даних ([детальніше про вирішення конфліктів](#merging-conflicts)).

Після завершення початкової односпрямованої синхронізації Anki зможе об'єднувати зміни з різних джерел, з деякими винятками.

Якщо кілька людей використовують Anki на одному комп'ютері і створили профіль для кожного користувача, кожен з них повинен створити окремий обліковий запис AnkiWeb для синхронізації. Синхронізація кількох профілів з одним обліковим записом AnkiWeb призведе до втрати даних

## Автоматична синхронізація

Після ввімкнення синхронізації Anki автоматично синхронізуватиме колекцію кожного разу, коли її буде закрито або відкрито. Якщо бажаєте синхронізувати вручну, автоматичну синхронізацію можна вимкнути в [налаштуваннях](preferences.md#syncing) Anki.

## Колір кнопки синхронізації

Кнопка синхронізації змінюватиме колір на синій, коли потрібна звичайна синхронізація, і на червоний, коли потрібна повна.

## Медіафайли

Пов'язане відео: <https://www.youtube.com/watch?v=phP9GGG-PxY>

Anki синхронізує всі звуки та зображення, що використовуються у нотатках. Програма відстежує, коли медіафайли додаються або видаляються з [папки медіафайлів](files.md#file-locations), але не помітить, якщо ви змінили наявні файли без додавання чи видалення. Щоб зміни були помічені, потрібно додати або видалити файл.

Односторонні синхронізації (коли з'являється запит на завантаження або вивантаження даних) не впливають на синхронізацію медіафайлів — зміни медіафайлів завжди об'єднуються.

Щоб уникнути випадкової втрати даних, видалення медіафайлів синхронізуються з іншими пристроями лише після повної синхронізації. Якщо файли видалено до завершення синхронізації і вони вже наявні на AnkiWeb, вони будуть завантажені під час наступної синхронізації.

Якщо випадково видалено медіафайли і їх потрібно відновити, відкрийте налаштування та виконайте вихід з облікового запису. Під час наступної синхронізації Anki відновить видалені файли, якщо вони ще доступні на AnkiWeb.

Якщо Anki використовується з [USB-накопичувача](files.md#running-from-a-flash-drive), рекомендується файлова система NTFS, оскільки Anki може не виявляти зміни медіафайлів у файловій системі FAT32.

## Конфлікти

Пов'язане відео: <https://www.youtube.com/watch?v=UEAcpfMQnjo>

За нормальних умов Anki може об'єднувати результати повторення та редагування нотаток, тому якщо ви виконали повторення або редагування на двох різних пристроях перед синхронізацією, Anki збереже зміни з обох пристроїв. Якщо одна й та сама картка була повторена на двох різних пристроях, обидва повторення будуть позначені в історії переглядів, а картка залишиться в стані, який був при останньому перегляді.

Однак існують певні зміни, які Anki не може об'єднати. Переважно це стосується формату нотаток: наприклад, додавання нового поля або видалення шаблону картки. Коли виконуєте операцію, яка не може бути об'єднана, Anki попередить і запропонує відмінити операцію. Якщо вирішите продовжити, вам буде запропоновано вибрати, чи зберігати локальну копію, чи копію на AnkiWeb під час наступної синхронізації колекції.

Якщо під час синхронізації будуть виявлені певні проблеми, Anki також змусить виконати односторонню синхронізацію. Якщо це трапляється постійно, будь ласка, опублікуйте повідомлення на нашому сайті підтримки.

Коли потрібна одностороння синхронізація, ви повинні вибрати, чи хочете зберегти колекцію з вашого локального пристрою, чи колекцію з AnkiWeb. Якщо зміни були внесені на обох пристроях, зберегти можна лише зміни одного з них.

Якщо виберете "Вивантажити", вміст локального пристрою буде відправлено на AnkiWeb. Потім потрібно синхронізувати інші пристрої та вибрати "Завантажити", щоб отримати копію цього вмісту.

Якщо ви виберете "Завантажити", це замінить будь-які локальні зміни даними з AnkiWeb.

Після синхронізації усіх пристроїв в подальшому синхронізації повернуться до нормальної поведінки об'єднання змін з обох кінців.

Якщо хочете примусово виконати повне вивантаження або завантаження (наприклад, якщо випадково видалили колоду на одному з пристроїв і хочете відновити її, а не синхронізувати її видалення), можете поставити прапорець "Під час наступної синхронізації примусити зміни в одному напрямку" в меню Інструменти > Налаштування > Мережа, а потім синхронізувати як зазвичай. (Вам буде надано можливість вибрати, який бік ви хочете використовувати.)

Примусова одностороння синхронізація впливає лише на синхронізацію карток - медіафайли синхронізуються як зазвичай. Якщо у вас є файли, які ви хочете видалити з AnkiWeb, будь ласка, спочатку переконайтеся, що ваш клієнт повністю синхронізований. Після того, як синхронізація буде актуальною, будь-які файли, які ви видалите (наприклад, через функцію Перевірка медіа), будуть видалені з AnkiWeb під час наступної синхронізації.

## Злиття конфліктів

Під час першого налаштування синхронізації зміни можна синхронізувати лише в одному напрямку. Якщо ви додали різний контент на різні пристрої або профілі до ввімкнення синхронізації, контент з одного пристрою буде втрачено, якщо ви перезапишете його даними з іншого. Проте ви можете вручну об'єднати дані в одну колекцію.

**Крок 1: Зробіть резервну копію даних**
Спершу створіть резервну копію на кожному пристрої/профілі, щоб уникнути втрати даних. На комп'ютері скористайтеся `Файл > Експортувати` для експорту "всіх колод" із включенням інформації про розклад і медіафайли, збережіть файл у безпечному місці. В AnkiMobile на екрані списку колод натисніть кнопку Додати/Експортувати, щоб експортувати всі колоди з медіа.

**Крок 2: Синхронізуйте перший пристрій**
Якщо одним із ваших пристроїв мобільний, синхронізуйте його першим. Якщо виникне конфлікт, оберіть "завантажити", щоб перезаписати всі дані на AnkiWeb даними з мобільного пристрою. Якщо обидва пристрої/профілі знаходяться на комп’ютері, спочатку синхронізуйте той, на якому найбільше колод.

**Крок 3: Підготуйте другий пристрій**
На іншому пристрої/профілі, якщо ввімкнено автоматичну синхронізацію, може з'явитися повідомлення з проханням завантажити або вивантажити дані. Натисніть кнопку скасування – ми ще не хочемо синхронізувати. Перебуваючи в списку колод, натисніть значок шестерні біля першої колоди та оберіть "експортувати". Експортуйте контент з інформацією про розклад і медіафайли, збережіть `.apkg` файл. Повторіть цю операцію для кожної основної колоди.

**Крок 4: Синхронізуйте другий пристрій**
Після експорту всіх основних колод натисніть кнопку синхронізації у верхньому правому куті та оберіть "завантажити", щоб перезаписати локальний контент даними, синхронізованими з іншого пристрою.

**Крок 5: Об'єднайте колоди**
Нарешті, скористайтесь `Файл > Імпорт`, щоб імпортувати `.apkg` файли, які ви експортували раніше. Це об'єднає експортований контент з існуючим, поєднавши все в одну колекцію.

## Брандмауери

Для синхронізації Anki необхідно мати можливість встановлювати вихідні HTTPS-з'єднання. Програма повинна підключатися до таких доменів, як ankiweb.net, sync.ankiweb.net, sync2.ankiweb.net тощо. Ці домени можуть змінюватися з часом, як і IP-адреси, на які вони вказують, тому рекомендується дозволити доступ до \*.ankiweb.net за допомогою символу підстановки (wildcard), щоб зменшити ймовірність необхідності оновлення правил брандмауера в майбутньому.

Якщо на вашому пристрої ввімкнено брандмауер, вам потрібно додати виключення для Anki. Якщо ви знаходитесь у робочій або шкільній мережі, зверніться до адміністратора мережі за допомогою — це питання, яке ми не зможемо вирішити самостійно.

## Проксі-сервери

Якщо для доступу до інтернету вам потрібен проксі-сервер, Anki автоматично підхопить налаштування системного проксі, якщо ви використовуєте Windows або macOS, і буде використовувати змінну середовища HTTP_PROXY на інших платформах.

Anki зможе підхопити системні налаштування, якщо проксі налаштовано вручну та не вимагає пароля. Якщо у вашій системі використовується автоматичне налаштування проксі або проксі з авторизацією (логіном і паролем), вам потрібно буде вручну вказати Anki конфігурацію проксі.

Щоб вказати налаштування проксі для Anki, задайте змінну середовища HTTPS_PROXY, що вказує на сервер проксі. Це має виглядати так:

    http://user:pass@proxy.company.com:8080

Якщо у вашому логіні або паролі є символ `@` (наприклад, `user@workdomain.com`), замініть його на `%40`, ось так:

    http://user%40workdomain.com:pass@proxy.company.com:8080

Anki 2.0 використовує змінну HTTP_PROXY замість HTTPS_PROXY.

Щоб налаштувати змінні середовища у Windows, дивіться [цю інструкцію](https://www.google.com/search?q=windows+set+environmental+variable).

Для налаштування на Mac, зверніться до [цього посібника](http://stackoverflow.com/questions/135688/setting-environment-variables-in-os-x).

Жорстко обмежені мережі, що перехоплюють захищені з'єднання та підміняють сертифікати, можуть викликати помилки SSL у Anki. У таких середовищах можна спробувати обійти ці помилки за допомогою [цього додатку](https://ankiweb.net/shared/info/878367706).

Альтернативним рішенням є встановлення локального проксі-сервера та його налаштування на ваш звичайний проксі. Тоді ви зможете вказати Anki використовувати локальний проксі, який буде перенаправляти запити на проксі-сервер, який ви зазвичай використовуєте.
